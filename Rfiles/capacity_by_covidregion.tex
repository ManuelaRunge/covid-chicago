% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={capacity\_by\_covidregion},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering

\title{capacity\_by\_covidregion}
\author{}
\date{\vspace{-2.5em}}

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(}\StringTok{"tidyverse"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## -- Attaching packages ------------------------------------------------------------------------------------------------------- tidyverse 1.3.0 --
\end{verbatim}

\begin{verbatim}
## v ggplot2 3.3.2     v purrr   0.3.4
## v tibble  3.0.3     v dplyr   1.0.0
## v tidyr   1.1.0     v stringr 1.4.0
## v readr   1.3.1     v forcats 0.5.0
\end{verbatim}

\begin{verbatim}
## -- Conflicts ---------------------------------------------------------------------------------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(}\StringTok{"cowplot"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## ********************************************************
\end{verbatim}

\begin{verbatim}
## Note: As of version 1.0.0, cowplot does not change the
\end{verbatim}

\begin{verbatim}
##   default ggplot2 theme anymore. To recover the previous
\end{verbatim}

\begin{verbatim}
##   behavior, execute:
##   theme_set(theme_cowplot())
\end{verbatim}

\begin{verbatim}
## ********************************************************
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(}\StringTok{"scales"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'scales'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:purrr':
## 
##     discard
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:readr':
## 
##     col_factor
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(}\StringTok{"lubridate"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Attaching package: 'lubridate'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:cowplot':
## 
##     stamp
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:base':
## 
##     date, intersect, setdiff, union
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(RColorBrewer)}
\NormalTok{getPalette =}\StringTok{ }\KeywordTok{colorRampPalette}\NormalTok{(}\KeywordTok{brewer.pal}\NormalTok{(}\DecValTok{8}\NormalTok{, }\StringTok{"Dark2"}\NormalTok{))(}\DecValTok{12}\NormalTok{)}
\KeywordTok{theme\_set}\NormalTok{(}\KeywordTok{theme\_cowplot}\NormalTok{())}

\KeywordTok{source}\NormalTok{(}\StringTok{"load\_paths.R"}\NormalTok{)}
\NormalTok{plot\_path \textless{}{-}}\StringTok{ }\KeywordTok{file.path}\NormalTok{(project\_path,}\StringTok{"Plots + Graphs"}\NormalTok{,}\StringTok{"capacity\_by\_covidregion"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{capacity}{%
\subsection{Capacity}\label{capacity}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{dat \textless{}{-}}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\KeywordTok{file.path}\NormalTok{(data\_path, }\StringTok{"/covid\_IDPH/Corona virus reports/capacity\_by\_covid\_region.csv"}\NormalTok{)) }\OperatorTok{\%\textgreater{}\%}
\StringTok{        }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{date=}\KeywordTok{as.Date}\NormalTok{(date))}\OperatorTok{\%\textgreater{}\%}
\StringTok{       }\KeywordTok{filter}\NormalTok{(geography\_level}\OperatorTok{==}\StringTok{"covid region"}\NormalTok{)}

\NormalTok{dat}\OperatorTok{$}\NormalTok{geography\_name \textless{}{-}}\StringTok{ }\KeywordTok{factor}\NormalTok{(dat}\OperatorTok{$}\NormalTok{geography\_name, }\DataTypeTok{levels=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{11}\NormalTok{), }\DataTypeTok{labels=}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\DecValTok{11}\NormalTok{))}
 \KeywordTok{head}\NormalTok{(dat)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##         date geography_level geography_name hb_total hb_open hb_used hb_covid
## 1 2020-10-30    covid region             11     8969    2357    6612      640
## 2 2020-09-19    covid region              8     3495    1367    2128      167
## 3 2020-04-08    covid region              5     1161     594     567       29
## 4 2020-04-06    covid region              7     1441     544     897      190
## 5 2020-03-24    covid region              9     1359     527     832        0
## 6 2020-08-23    covid region              9     1923     868    1055      104
##   hb_noncovid hb_availforcovid icu_total icu_open icu_used icu_covid
## 1        5972             2997      1064      303      761       161
## 2        1961             1534       431      180      251        33
## 3         538              623        77       35       42         7
## 4         707              734       140       31      109        63
## 5         832              527       121       48       73         0
## 6         951              972       254      138      116        13
##   icu_noncovid icu_availforcovid vent_total vent_open vent_used vent_covid
## 1          600               464       1808      1297       511         74
## 2          197               212        581       401       180         12
## 3           35                42         88        75        13          3
## 4           46                94        102        50        52         48
## 5           27                22         96        60        36         NA
## 6          103               151        301       283        18          5
##   vent_noncovid medsurg_total medsurg_open medsurg_used medsurg_covid
## 1           437          4473         1008         3465           479
## 2           159          1906          630         1276           134
## 3            10           611          308          303            22
## 4             4           686          201          485           127
## 5            NA           773          206          567             0
## 6            13          1117          445          672            91
##   medsurg_noncovid hb_nonicu_total hb_nonicu_open hb_nonicu_used
## 1             2986            7905           2054           5851
## 2             1142            3064           1187           1877
## 3              281            1084            559            525
## 4              358            1301            513            788
## 5              567            1238            479            759
## 6              581            1669            730            939
##   hb_nonicu_covid hb_nonicu_noncovid
## 1             479               5372
## 2             134               1611
## 3              22                503
## 4             127                661
## 5               0                178
## 6              91                848
\end{verbatim}

\hypertarget{including-plots}{%
\subsection{Including Plots}\label{including-plots}}

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{table}\NormalTok{(dat}\OperatorTok{$}\NormalTok{geography\_level)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## covid region 
##         2497
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{hosp\_countVars \textless{}{-}}\StringTok{ }\KeywordTok{colnames}\NormalTok{(dat)}
\NormalTok{hosp\_countVars \textless{}{-}}\StringTok{ }\NormalTok{hosp\_countVars[}\KeywordTok{which}\NormalTok{(}\OperatorTok{!}\NormalTok{(hosp\_countVars }\OperatorTok{\%in\%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{\textquotesingle{}date\textquotesingle{}}\NormalTok{, }\StringTok{\textquotesingle{}geography\_level\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}geography\_name\textquotesingle{}}\NormalTok{)))]}

\NormalTok{days\_dates \textless{}{-}}\StringTok{ }\KeywordTok{seq}\NormalTok{(}\KeywordTok{as.Date}\NormalTok{(}\KeywordTok{min}\NormalTok{(dat}\OperatorTok{$}\NormalTok{date)) , }\KeywordTok{as.Date}\NormalTok{(}\KeywordTok{max}\NormalTok{(dat}\OperatorTok{$}\NormalTok{date)), }\StringTok{"days"}\NormalTok{)}
\NormalTok{weekend\_dates \textless{}{-}}\StringTok{ }\NormalTok{days\_dates[}\KeywordTok{which}\NormalTok{(}\KeywordTok{weekdays}\NormalTok{(days\_dates) }\OperatorTok{\%in\%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"Saturday"}\NormalTok{,}\StringTok{"Sunday"}\NormalTok{))]}
\NormalTok{saturday\_dates \textless{}{-}}\StringTok{ }\NormalTok{days\_dates[}\KeywordTok{which}\NormalTok{(}\KeywordTok{weekdays}\NormalTok{(days\_dates) }\OperatorTok{\%in\%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"Saturday"}\NormalTok{))]}
\NormalTok{sunday\_dates \textless{}{-}}\StringTok{ }\NormalTok{days\_dates[}\KeywordTok{which}\NormalTok{(}\KeywordTok{weekdays}\NormalTok{(days\_dates) }\OperatorTok{\%in\%}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"Sunday"}\NormalTok{))]}
\NormalTok{weekendDat \textless{}{-}}\StringTok{ }\KeywordTok{cbind}\NormalTok{(}\StringTok{\textquotesingle{}saturday\textquotesingle{}}\NormalTok{=}\KeywordTok{as.character}\NormalTok{(saturday\_dates), }\StringTok{\textquotesingle{}sunday\textquotesingle{}}\NormalTok{=}\KeywordTok{as.character}\NormalTok{(sunday\_dates)) }\OperatorTok{\%\textgreater{}\%}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{()}
\NormalTok{weekendDat}\OperatorTok{$}\NormalTok{saturday \textless{}{-}}\StringTok{ }\KeywordTok{as.Date}\NormalTok{(weekendDat}\OperatorTok{$}\NormalTok{saturday)}
\NormalTok{weekendDat}\OperatorTok{$}\NormalTok{sunday \textless{}{-}}\StringTok{ }\KeywordTok{as.Date}\NormalTok{(weekendDat}\OperatorTok{$}\NormalTok{sunday)}


\NormalTok{pplots \textless{}{-}}\StringTok{ }\KeywordTok{list}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{(var }\ControlFlowTok{in}\NormalTok{ hosp\_countVars)\{}
\NormalTok{dat \textless{}{-}}\StringTok{ }\KeywordTok{as.data.frame}\NormalTok{(dat)}
\NormalTok{dat}\OperatorTok{$}\NormalTok{var \textless{}{-}}\StringTok{ }\NormalTok{dat[,}\KeywordTok{colnames}\NormalTok{(dat)}\OperatorTok{==}\NormalTok{var]}

\NormalTok{pplot \textless{}{-}}\StringTok{ }\KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data=}\NormalTok{dat)}\OperatorTok{+}
\StringTok{  }\KeywordTok{background\_grid}\NormalTok{(}\DataTypeTok{major =} \KeywordTok{c}\NormalTok{(}\StringTok{"y"}\NormalTok{))}\OperatorTok{+}
\StringTok{ }\CommentTok{\# geom\_rect(data = weekendDat, aes(xmin = saturday, xmax = sunday, ymin = 0, ymax = Inf), alpha = 0.2) +}
\StringTok{  }\KeywordTok{geom\_vline}\NormalTok{(}\DataTypeTok{xintercept =}\NormalTok{ sunday\_dates, }\DataTypeTok{col=}\StringTok{"grey"}\NormalTok{, }\DataTypeTok{size=}\FloatTok{0.5}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom\_area}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{date, }\DataTypeTok{y=}\NormalTok{var, }\DataTypeTok{fill=}\NormalTok{geography\_name)) }\OperatorTok{+}
\StringTok{    }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{y=}\NormalTok{var, }\DataTypeTok{x=}\StringTok{""}\NormalTok{, }\DataTypeTok{fill=}\StringTok{"Covid region"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{scale\_fill\_manual}\NormalTok{(}\DataTypeTok{values =}\NormalTok{getPalette)}\OperatorTok{+}
\StringTok{  }\KeywordTok{scale\_y\_continuous}\NormalTok{(}\DataTypeTok{expand=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{), }\DataTypeTok{labels=}\NormalTok{comma) }\OperatorTok{+}
\StringTok{  }\KeywordTok{scale\_x\_date}\NormalTok{(}\DataTypeTok{expand=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{), }\DataTypeTok{date\_breaks =} \StringTok{"30 days"}\NormalTok{, }\DataTypeTok{date\_labels =} \StringTok{"\%d}\CharTok{\textbackslash{}n}\StringTok{\%b"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom\_hline}\NormalTok{(}\DataTypeTok{yintercept =} \OtherTok{Inf}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom\_vline}\NormalTok{(}\DataTypeTok{xintercept =} \OtherTok{Inf}\NormalTok{)}

\NormalTok{SAVE=}\OtherTok{FALSE}
\ControlFlowTok{if}\NormalTok{(SAVE)\{}
   \KeywordTok{ggsave}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(var, }\StringTok{"\_region\_plot\_stacked.png"}\NormalTok{),}
           \DataTypeTok{plot =}\NormalTok{ pplot,}
           \DataTypeTok{path =} \KeywordTok{file.path}\NormalTok{(plot\_path), }\DataTypeTok{width =} \DecValTok{10}\NormalTok{, }\DataTypeTok{height =} \DecValTok{6}\NormalTok{, }\DataTypeTok{device =} \StringTok{"png"}
\NormalTok{    )}
   
\NormalTok{   pplots[[}\KeywordTok{length}\NormalTok{(pplots)}\OperatorTok{+}\DecValTok{1}\NormalTok{]] \textless{}{-}}\StringTok{ }\NormalTok{pplot}
   \KeywordTok{rm}\NormalTok{(pplot)}
\NormalTok{\}}
\NormalTok{\}}

\NormalTok{printPLots=}\OtherTok{TRUE}
\ControlFlowTok{if}\NormalTok{(printPLots)pplots}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## list()
\end{verbatim}

\end{document}
