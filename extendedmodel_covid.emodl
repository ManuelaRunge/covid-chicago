; simplemodel

(import (rnrs) (emodl cmslib))

(start-model "seir.emodl")

(species S 990)
(species E 0)
(species I 10)
(species Sy 0)
(species H 0)
(species C 0)
(species D 0)
(species R 0)

(observe susceptible S)
(observe exposed E)
(observe infectious  I)
(observe symptomatic  Sy)
(observe hospitalized  H)
(observe critical  C)
(observe deaths D)
(observe recovered R)

;(observe population  (sum S E I Sy H C D R))
;(observe clock       time)
;(observe moonphase   (* 500 (+ 1 (sin (* (/ time 29.5) 2 pi)))))
;(observe fivec       500)


(param incubation_pd 6.63)
(param time_to_hospitalization 6)
(param time_to_critical 6)
(param time_to_death 2)
(param recovery_rate 16)
(param waning 180)

(param Ki 0.0005)
(param Kr (/ 1 recovery_rate))
(param Kw (/ 1 waning))
(param Kl (/ 0.3 incubation_pd))
(param Ks (/ 0.7 incubation_pd))
(param Kh (/ 0.3 time_to_hospitalization))
(param Kc (/ 0.8 time_to_critical ))
(param Km (/ 0.016 time_to_death))

(reaction exposure   (S I) (E I) (* Ki S (+ I Sy)))
(reaction infection  (E)   (I)   (* Kl E))
(reaction symptomatic (E)   (Sy)   (* Kl E))

(reaction hospitalization   (Sy)   (H)   (* Kh Sy))
(reaction critical   (H)   (C)   (* Kc H))
(reaction death   (C)   (D)   (* Km C))

(reaction recovery   (I)   (R)   (* Kr I))
(reaction recovery   (Sy)   (R)   (* (- 1 Kh)  Sy))
(reaction recovery   (H)   (R)   (* (- 1 Kc) H))
(reaction recovery   (C)   (R)   (* (- 1 Km) C))

(reaction waning     (R)   (S)   (* Kw R))

(end-model)

